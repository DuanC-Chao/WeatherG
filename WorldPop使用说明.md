# WorldPop本地人口密度查询工具使用说明

## 快速开始

### 步骤1: 下载数据文件
1. 访问 WorldPop 官网：https://data.worldpop.org/GIS/Population/Global_2000_2020/
2. 选择年份文件夹（如 2020/）
3. 进入 CHN/ 文件夹
4. 下载文件：`chn_ppp_2020.tif` (约5GB)

### 步骤2: 文件放置
将下载的文件放在脚本同目录下，文件名格式：
- `chn_ppp_2020.tif` - 2020年数据
- `chn_ppp_2019.tif` - 2019年数据
- `chn_ppp_2018.tif` - 2018年数据
- ...

### 步骤3: 运行查询

#### 命令行方式（推荐）
```bash
# 查询单个年份
python local_population_query.py 39.9042 116.4074 2020

# 查询所有可用年份
python local_population_query.py 39.9042 116.4074
```

#### 交互式方式
```bash
python local_population_query.py
```
然后按提示输入坐标和选择查询模式。

## 输出结果示例

### 单年份查询结果
```
📊 2020年人口密度数据
============================================================
📍 查询坐标: (39.9042, 116.4074)
🎯 像素位置: 第1284行, 第2156列

👥 人口密度信息:
• 人口密度: 1205.67 人/平方公里
• 该像素总人口: 1205 人
• 像素面积: 1.0000 平方公里

🌐 周边区域统计 (5×5像素):
• 平均密度: 987.43 人/平方公里
• 中位数密度: 856.21 人/平方公里
• 最高密度: 2341.89 人/平方公里
• 最低密度: 234.56 人/平方公里
• 标准差: 445.78

📐 不同半径范围分析:
• 1像素半径 (~1.0km): 平均1089.2人/km², 总人口9803人, 面积9.0km²
• 3像素半径 (~3.0km): 平均956.7人/km², 总人口38267人, 面积40.0km²
• 5像素半径 (~5.0km): 平均823.4人/km², 总人口65889人, 面积80.0km²
```

### 多年份查询结果
```
📊 多年份人口密度数据汇总
======================================================================
📍 查询坐标: (39.9042, 116.4074)
✅ 成功查询: 5 年
❌ 查询失败: 0 年
📈 成功率: 100.0%

📋 历年数据对比:
----------------------------------------------------------------------
年份     人口密度      像素人口    周边平均      状态    
----------------------------------------------------------------------
2000     956.2        956        834.5        成功    
2005     1024.7       1025       891.2        成功    
2010     1156.4       1156       967.8        成功    
2015     1189.3       1189       1023.4       成功    
2020     1205.7       1206       987.4        成功    

📈 人口密度变化趋势:
• 2000年: 956.2 人/平方公里
• 2020年: 1205.7 人/平方公里
• 绝对变化: +249.5 人/平方公里
• 相对变化: +26.1%
• 年均增长率: +1.18%
```

## 主要功能特点

1. **精确查询**: 直接从GeoTIFF文件提取指定坐标的人口密度
2. **多年对比**: 支持查询2000-2020年间的所有可用数据
3. **区域分析**: 提供周边区域的统计分析
4. **趋势分析**: 自动计算人口密度变化趋势和增长率
5. **数据导出**: 支持将结果导出为JSON格式

## 坐标示例

- **北京天安门**: 39.9042, 116.4074
- **上海人民广场**: 31.2304, 121.4737
- **深圳市民中心**: 22.5431, 114.0579
- **广州天河**: 23.1167, 113.2500

## 注意事项

1. **文件大小**: 每个年份的文件约5GB，确保有足够存储空间
2. **数据精度**: WorldPop数据分辨率约1km×1km，适合宏观分析
3. **坐标格式**: 使用十进制度数格式（WGS84坐标系）
4. **覆盖范围**: 仅支持中国大陆地区坐标

## 常见问题

**Q: 查询结果为0是否正常？**
A: 是的，海洋、湖泊、山区等无人居住区域人口密度为0。

**Q: 如何获取更精确的人口数据？**
A: WorldPop提供的是1km网格数据，如需更精确数据请考虑其他数据源。

**Q: 支持其他国家的数据吗？**  
A: 当前脚本仅支持中国数据，但可以修改以支持其他国家。

---

*数据来源: WorldPop Project, University of Southampton*  
*工具开发: WeatherG环境监测项目组* 